!function(n,a,s,t){"use strict";function e(a,s){this.element=a,this.settings=n.extend({},i,s),this._defaults=i,this._name=c,this.init()}var c="password",i={minLength:8,minAcceptableScore:30,allowSpace:!1,change:function(){},strengthIndicator:null,strengthIndicatorBars:'<div class="pw_strengthIndicator"><div class="strength weak">Weak</div><div class="strength medium">Medium</div><div class="strength strong">Strong</div></div>',personalInformation:[],checklist:null,dictionary:null,doubleType:null},l=null,r=null,h=null;e.prototype={init:function(){var a=n(this.element),s=this.settings;n.each(s.personalInformation,function(a,t){"string"==typeof t&&n(t).length>0&&(s.personalInformation[a]=n(t))}),null!=s.doubleType&&(h="string"==typeof s.doubleType?n(s.doubleType):s.doubleType,h.on("keyup change",function(){null!=r&&(r.find(".pw_check_match").removeClass("pass"),a.val()==h.val()&&r.find(".pw_check_match").addClass("pass"))}));var t=this.calculateScore(a,s);null!=s.strengthIndicator&&(l="string"==typeof s.strengthIndicator?n(s.strengthIndicator):s.strengthIndicator,l.html(s.strengthIndicatorBars),this.updateStrengthIndicator(t,l)),null!=s.checklist&&(r="string"==typeof s.checklist?n(s.checklist):s.checklist,r.html('<div class="pw_checklist"><ul><li class="pw_check_length">Length of at least '+s.minLength+' characters</li><li class="pw_check_uclc">Contains uppercase and lowercase letters</li><li class="pw_check_nums">Contains numbers</li><li class="pw_check_special">Contains special characters</li><li class="pw_check_spaces">Doesn\'t contain spaces</li><li class="pw_check_personal">Doesn\'t contain personal information</li><li class="pw_check_dictionary">Doesn\'t contain common password words</li><li class="pw_check_match">Passwords match</li></ul></div>'),0==s.personalInformation.length&&r.find(".pw_check_personal").remove(),s.allowSpace&&r.find(".pw_check_spaces").remove(),s.minLength<1&&r.find(".pw_check_length").remove(),null==s.dictionary&&r.find(".pw_check_dictionary").remove(),null==h&&r.find(".pw_check_match").remove(),this.updateChecklist(a,h,t,r)),null!=s.dictionary&&n.getJSON(s.dictionary,function(n){s.dictionaryWords=n});var e=this;a.on("keyup change",function(n){var t=e.calculateScore(a,s);null!=l&&e.updateStrengthIndicator(t,l),null!=r&&e.updateChecklist(a,h,t,r),s.change.call(this,t[0],t[1],t[2])}),s.change.call(this,t[0],t[1],t[2])},updateChecklist:function(a,s,t,e){e.find(".pass").removeClass("pass"),-1==n.inArray("TOO_SHORT",t[1])&&e.find(".pw_check_length").addClass("pass"),-1==n.inArray("NO_UPPERCASE_LETTERS",t[1])&&-1==n.inArray("NO_LOWERCASE_LETTERS",t[1])&&e.find(".pw_check_uclc").addClass("pass"),-1==n.inArray("NO_NUMBERS",t[1])&&e.find(".pw_check_nums").addClass("pass"),-1==n.inArray("NO_SPECIAL_CHARACTERS",t[1])&&e.find(".pw_check_special").addClass("pass"),-1==n.inArray("CONTAINS_SPACE",t[1])&&e.find(".pw_check_spaces").addClass("pass"),-1==n.inArray("CONTAINS_PERSONAL_INFO",t[1])&&e.find(".pw_check_personal").addClass("pass"),-1==n.inArray("CONTAINS_COMMON_WORD",t[1])&&e.find(".pw_check_dictionary").addClass("pass"),-1==n.inArray("PASSWORDS_DO_NOT_MATCH",t[1])&&e.find(".pw_check_match").addClass("pass")},updateStrengthIndicator:function(n,a){a.find(".pass").removeClass("pass"),n[2]&&(a.find(".weak").addClass("pass"),n[0]>=50&&a.find(".medium").addClass("pass"),n[0]>=80&&a.find(".strong").addClass("pass"))},calculateScore:function(a,s){var e=a.val();if("object"==typeof s){var c=0,i=90,l=!0,r=[];e.length>=s.minLength?c+=10:(r.push("TOO_SHORT"),l=!1),null!=e.match(/[A-Z]/g)?c+=10:r.push("NO_UPPERCASE_LETTERS"),null!=e.match(/[a-z]/g)?c+=10:r.push("NO_LOWERCASE_LETTERS"),null!=e.match(/[0-9]/g)?c+=10:r.push("NO_NUMBERS"),s.allowSpace||null==e.match(/ /g)||(r.push("CONTAINS_SPACE"),l=!1),null!=e.match(/(\W|_)/g)?c+=10:r.push("NO_SPECIAL_CHARACTERS");var o=[];n.each(s.personalInformation,function(a,s){if("string"!=typeof s&&(s=s.val().toString()),s.length>0){var t=s.toLowerCase().split(" ");n.each(t,function(n,a){o.push(a);var s=a.match(/[1-2][0-9]{3}/g);s&&o.push(s[0].substring(2,4))})}});var p=!1;n.each(o,function(n,a){var s=new RegExp(a,"gi");null!=e.match(s)&&(p=!0)}),p?r.push("CONTAINS_PERSONAL_INFO"):e.length>5&&(c+=20);var d=!1;s.dictionaryWords!==t&&n.each(s.dictionaryWords,function(n,a){var s=new RegExp(a,"gi");null!=e.match(s)&&(d=!0)}),d?r.push("CONTAINS_COMMON_WORD"):e.length>5&&(c+=20),a.val()!=h.val()&&(l=!1,r.push("PASSWORDS_DO_NOT_MATCH"));var u=c/i*100;if(u<s.minAcceptableScore&&(l=!1),0==e.length&&(l=!1,r.push("EMPTY")),a.attr("name")!==t){var _=n('input[name="'+a.attr("name")+'_pass"]');_.length>0?_.val(l):a.after('<input type="hidden" name="'+a.attr("name")+'_pass" value="'+l+'" />')}return[u,r,l]}return null}},n.fn[c]=function(a){return this.each(function(){n.data(this,"plugin_"+c)||n.data(this,"plugin_"+c,new e(this,a))})}}(jQuery,window,document);