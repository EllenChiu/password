(function(e){var n={init:function(t){var n=e.extend({minLength:8,minAcceptableScore:30,allowSpace:false,change:function(){},strengthIndicator:null,strengthIndicatorBars:'<div class="pw_strengthIndicator"><div class="strength weak">Weak</div><div class="strength medium">Medium</div><div class="strength strong">Strong</div></div>',personalInformation:[],checklist:null,dictionary:null,doubleType:null},t);this.each(function(){var t=e(this);t.data("jq_password",n);var r=null;var i=null;var s=null;e.each(n.personalInformation,function(t,r){if(typeof r=="string"){if(e(r).length>0){n.personalInformation[t]=e(r)}}});var o=e.fn.password("calculateScore",t);if(n.strengthIndicator!=null){if(typeof n.strengthIndicator=="string"){r=e(n.strengthIndicator)}else{r=n.strengthIndicator}r.html(n.strengthIndicatorBars);e.fn.password("updateStrengthIndicator",o,r)}if(n.doubleType!=null){if(typeof n.doubleType=="string"){s=e(n.doubleType)}else{s=n.doubleType}s.on("keyup change",function(){if(i!=null){i.find(".pw_check_match").removeClass("pass");if(t.val()==s.val()){i.find(".pw_check_match").addClass("pass")}}})}if(n.checklist!=null){if(typeof n.checklist=="string"){i=e(n.checklist)}else{i=n.checklist}i.html('<div class="pw_checklist"><ul><li class="pw_check_length">Length of at least '+n.minLength+' characters</li><li class="pw_check_uclc">Contains uppercase and lowercase letters</li><li class="pw_check_nums">Contains numbers</li><li class="pw_check_special">Contains special characters</li><li class="pw_check_spaces">Doesn\'t contain spaces</li><li class="pw_check_personal">Doesn\'t contain personal information</li><li class="pw_check_dictionary">Doesn\'t contain common password words</li><li class="pw_check_match">Passwords match</li></ul></div>');if(n.personalInformation.length==0){i.find(".pw_check_personal").remove()}if(n.allowSpace){i.find(".pw_check_spaces").remove()}if(n.minLength<1){i.find(".pw_check_length").remove()}if(n.dictionary==null){i.find(".pw_check_dictionary").remove()}if(s==null){i.find(".pw_check_match").remove()}e.fn.password("updateChecklist",o,i)}if(n.dictionary!=null){e.getJSON(n.dictionary,function(e){n.dictionaryWords=e})}t.on("keyup change",function(){var s=e.fn.password("calculateScore",t);if(r!=null){e.fn.password("updateStrengthIndicator",s,r)}if(i!=null){e.fn.password("updateChecklist",s,i)}n.change.call(this,s[0],s[1],s[2])});n.change.call(this,o[0],o[1],o[2])})},calculate:function(){var t=e(this);if(typeof t.data("jq_password")=="object"){return e.fn.password("calculateScore",t)}return null},updateChecklist:function(e,n){n.find(".pass").removeClass("pass");if(jQuery.inArray("TOO_SHORT",e[1])==-1){n.find(".pw_check_length").addClass("pass")}if(jQuery.inArray("NO_UPPERCASE_LETTERS",e[1])==-1&&jQuery.inArray("NO_LOWERCASE_LETTERS",e[1])==-1){n.find(".pw_check_uclc").addClass("pass")}if(jQuery.inArray("NO_NUMBERS",e[1])==-1){n.find(".pw_check_nums").addClass("pass")}if(jQuery.inArray("NO_SPECIAL_CHARACTERS",e[1])==-1){n.find(".pw_check_special").addClass("pass")}if(jQuery.inArray("CONTAINS_SPACE",e[1])==-1){n.find(".pw_check_spaces").addClass("pass")}if(jQuery.inArray("CONTAINS_PERSONAL_INFO",e[1])==-1){n.find(".pw_check_personal").addClass("pass")}if(jQuery.inArray("CONTAINS_COMMON_WORD",e[1])==-1){n.find(".pw_check_dictionary").addClass("pass")}if(t.val()==dt.val()){n.find(".pw_check_match").addClass("pass")}},updateStrengthIndicator:function(e,t){t.find(".pass").removeClass("pass");if(e[2]){t.find(".weak").addClass("pass");if(e[0]>=50){t.find(".medium").addClass("pass")}if(e[0]>=80){t.find(".strong").addClass("pass")}}},calculateScore:function(t){var n=t.val();var r=t.data("jq_password");if(typeof r=="object"){var i=0;var s=90;var o=true;var u=[];if(n.length>=r.minLength){i+=10}else{u.push("TOO_SHORT");o=false}if(n.match(/[A-Z]/g)!=null){i+=10}else{u.push("NO_UPPERCASE_LETTERS")}if(n.match(/[a-z]/g)!=null){i+=10}else{u.push("NO_LOWERCASE_LETTERS")}if(n.match(/[0-9]/g)!=null){i+=10}else{u.push("NO_NUMBERS")}if(!r.allowSpace&&n.match(/ /g)!=null){u.push("CONTAINS_SPACE");o=false}if(n.match(/(\W|_)/g)!=null){i+=10}else{u.push("NO_SPECIAL_CHARACTERS")}var a=[];e.each(r.personalInformation,function(t,n){if(typeof n!="string"){n=n.val()}if(n.length>0){var r=n.toLowerCase().split(" ");e.each(r,function(e,t){a.push(t);var n=t.match(/[1-2][0-9]{3}/g);if(n){a.push(n[0].substring(2,4))}})}});var f=n.toLowerCase();var l=false;e.each(a,function(e,t){var n=new RegExp(t,"g");if(f.match(n)!=null){l=true}});if(l){u.push("CONTAINS_PERSONAL_INFO")}else if(n.length>5){i+=20}var c=false;if(r.dictionaryWords!==undefined){e.each(r.dictionaryWords,function(e,t){var n=new RegExp(t,"g");if(f.match(n)!=null){c=true}})}if(c){u.push("CONTAINS_COMMON_WORD")}else if(n.length>5){i+=20}var h=i/s*100;if(h<r.minAcceptableScore){o=false}if(n.length==0){o=false;u.push("EMPTY")}if(t.attr("name")!==undefined){var p=e('input[name="'+t.attr("name")+'_pass"]');if(p.length>0){p.val(o)}else{t.after('<input type="hidden" name="'+t.attr("name")+'_pass" value="'+o+'" />')}}return[h,u,o]}else{return null}}};e.fn.password=function(t){if(n[t]){return n[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return n.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.password")}}})(jQuery)