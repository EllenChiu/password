(function(b){var a={init:function(c){var d=b.extend({minLength:8,minAcceptableScore:0.3,allowSpace:false,change:function(){},strengthIndicator:null,strengthIndicatorBars:'<div class="pw_strengthIndicator"><div class="strength weak">Weak</div><div class="strength medium">Medium</div><div class="strength strong">Strong</div></div>',personalInformation:[],checklist:null,dictionary:null,doubleType:null},c);this.each(function(){var g=b(this);var f=null;var e=null;var h=null;b.each(d.personalInformation,function(j,k){if(typeof(k)=="string"){if(b(k).length>0){d.personalInformation[j]=b(k)}}});var i=b.fn.password("calculateScore",g,d);if(d.strengthIndicator!=null){if(typeof(d.strengthIndicator)=="string"){f=b(d.strengthIndicator)}else{f=d.strengthIndicator}f.html(d.strengthIndicatorBars);if(i[2]){f.find(".weak").addClass("pass");if(i[0]>=50){f.find(".medium").addClass("pass")}if(i[0]>=80){f.find(".strong").addClass("pass")}}}if(d.doubleType!=null){if(typeof(d.doubleType)=="string"){h=b(d.doubleType)}else{h=d.doubleType}h.keyup(function(){if(e!=null){e.find(".pw_check_match").removeClass("pass");if(g.val()==h.val()){e.find(".pw_check_match").addClass("pass")}}})}if(d.checklist!=null){if(typeof(d.checklist)=="string"){e=b(d.checklist)}else{e=d.checklist}e.html('<div class="pw_checklist"><ul><li class="pw_check_length">Length of at least '+d.minLength+' characters</li><li class="pw_check_uclc">Contains uppercase and lowercase letters</li><li class="pw_check_nums">Contains numbers</li><li class="pw_check_special">Contains special characters</li><li class="pw_check_spaces">Doesn\'t contain spaces</li><li class="pw_check_personal">Doesn\'t contain personal information</li><li class="pw_check_dictionary">Doesn\'t contain common password words</li><li class="pw_check_match">Passwords match</li></ul></div>');if(d.personalInformation.length==0){e.find(".pw_check_personal").remove()}if(d.allowSpace){e.find(".pw_check_spaces").remove()}if(d.minLength<1){e.find(".pw_check_length").remove()}if(d.dictionary==null){e.find(".pw_check_dictionary").remove()}if(h==null){e.find(".pw_check_match").remove()}if(jQuery.inArray("TOO_SHORT",i[1])==-1){e.find(".pw_check_length").addClass("pass")}if(jQuery.inArray("NO_UPPERCASE_LETTERS",i[1]==-1)&&jQuery.inArray("NO_LOWERCASE_LETTERS",i[1])==-1){e.find(".pw_check_uclc").addClass("pass")}if(jQuery.inArray("NO_NUMBERS",i[1])==-1){e.find(".pw_check_nums").addClass("pass")}if(jQuery.inArray("NO_SPECIAL_CHARACTERS",i[1])==-1){e.find(".pw_check_special").addClass("pass")}if(jQuery.inArray("CONTAINS_SPACE",i[1])==-1){e.find(".pw_check_spaces").addClass("pass")}if(jQuery.inArray("CONTAINS_PERSONAL_INFO",i[1])==-1){e.find(".pw_check_personal").addClass("pass")}if(jQuery.inArray("CONTAINS_COMMON_WORD",i[1])==-1){e.find(".pw_check_dictionary").addClass("pass")}if(g.val()==h.val()){e.find(".pw_check_match").addClass("pass")}}if(d.dictionary!=null){b.getJSON(d.dictionary,function(j){d.dictionaryWords=j})}g.keyup(function(){var j=b.fn.password("calculateScore",g,d);if(f!=null){f.find(".pass").removeClass("pass");if(j[2]){f.find(".weak").addClass("pass");if(j[0]>=50){f.find(".medium").addClass("pass")}if(j[0]>=80){f.find(".strong").addClass("pass")}}}if(e!=null){e.find(".pass").removeClass("pass");if(jQuery.inArray("TOO_SHORT",j[1])==-1){e.find(".pw_check_length").addClass("pass")}if(jQuery.inArray("NO_UPPERCASE_LETTERS",j[1])==-1&&jQuery.inArray("NO_LOWERCASE_LETTERS",j[1])==-1){e.find(".pw_check_uclc").addClass("pass")}if(jQuery.inArray("NO_NUMBERS",j[1])==-1){e.find(".pw_check_nums").addClass("pass")}if(jQuery.inArray("NO_SPECIAL_CHARACTERS",j[1])==-1){e.find(".pw_check_special").addClass("pass")}if(jQuery.inArray("CONTAINS_SPACE",j[1])==-1){e.find(".pw_check_spaces").addClass("pass")}if(jQuery.inArray("CONTAINS_PERSONAL_INFO",j[1])==-1){e.find(".pw_check_personal").addClass("pass")}if(jQuery.inArray("CONTAINS_COMMON_WORD",j[1])==-1){e.find(".pw_check_dictionary").addClass("pass")}if(g.val()==h.val()){e.find(".pw_check_match").addClass("pass")}}d.change.call(this,j[0],j[1],j[2])});d.change.call(this,i[0],i[1],i[2])})},calculateScore:function(f,g){var m=f.val();var e=0;var d=90;var l=true;var k=[];if(m.length>=g.minLength){e+=10}else{k.push("TOO_SHORT");l=false}if(m.match(/[A-Z]/g)!=null){e+=10}else{k.push("NO_UPPERCASE_LETTERS")}if(m.match(/[a-z]/g)!=null){e+=10}else{k.push("NO_LOWERCASE_LETTERS")}if(m.match(/[0-9]/g)!=null){e+=10}else{k.push("NO_NUMBERS")}if(!g.allowSpace&&m.match(/ /g)!=null){k.push("CONTAINS_SPACE");l=false}if(m.match(/(\W|_)/g)!=null){e+=10}else{k.push("NO_SPECIAL_CHARACTERS")}var h=[];b.each(g.personalInformation,function(o,p){if(typeof(p)!="string"){p=p.val()}if(p.length>0){var n=p.toLowerCase().split(" ");b.each(n,function(s,r){h.push(r);var t=r.match(/[1-2][0-9]{3}/g);if(t){h.push(t[0].substring(2,4))}})}});var c=m.toLowerCase();var i=false;b.each(h,function(n,p){var o=new RegExp(p,"g");if(c.match(o)!=null){i=true}});if(i){k.push("CONTAINS_PERSONAL_INFO")}else{if(m.length>5){e+=20}}var j=false;if(g.dictionaryWords!==undefined){b.each(g.dictionaryWords,function(n,p){var o=new RegExp(p,"g");if(c.match(o)!=null){j=true}})}if(j){k.push("CONTAINS_COMMON_WORD")}else{if(m.length>5){e+=20}}if((e/d)<g.minAcceptableScore){l=false}if(m.length==0){l=false;k.push("EMPTY")}return[(e/d)*100,k,l]}};b.fn.password=function(c){if(a[c]){return a[c].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof c==="object"||!c){return a.init.apply(this,arguments)}else{b.error("Method "+c+" does not exist on jQuery.password")}}}})(jQuery);
